<!doctype html>







































<html
  class="not-ready lg:text-base"
  style="--bg: #fbfbfb"
  lang="en-us"
  dir="ltr"
>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>[MAD] Entry-01 : Evil Deno Caught In Wild - TheAbsnt</title>

  
  <meta name="theme-color" />

  
  
  
  
  <meta name="description" content="
Context of this Entry
The context originates from MalwareHunterTeam Tweet. This introduces an executable named GoogleDriverSetup.exe, It is compiled using Rust based JavaScript runtime called Deno. Let&rsquo;s get started!

stage01 : Evil Deno
It all starts with an executable that sizes to approx.81.4MB, it&rsquo;s a DenoJS compiled executable:

This holds the JavaScript to run in the resources section of the binary. This technique is referenced from Evil Deno.

The JavaScript can be deobfuscated using deobfuscate.io. This simply contains a powershell command that&rsquo;ll execute another powershell script loaded from remote URL dynamically:
" />
  <meta name="author" content="THEABSNT" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="https://theabsnt.github.io/main.min.css" />

  
  
  
  
  
  <link rel="preload" as="image" href="https://theabsnt.github.io/theme.svg" />

  
  
  
  
  <link rel="preload" as="image" href="https://images.unsplash.com/photo-1568430462989-44163eb1752f?w=500&amp;auto=format&amp;fit=crop&amp;q=60&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwcm9maWxlLXBhZ2V8OXx8fGVufDB8fHx8fA%3D%3D" />
  
  

  
  
  <link rel="preload" as="image" href="https://theabsnt.github.io/twitter.svg" />
  
  <link rel="preload" as="image" href="https://theabsnt.github.io/rss.svg" />
  
  

  
  
  <script
    defer
    src="https://theabsnt.github.io/highlight.min.js"
    onload="hljs.initHighlightingOnLoad();"
  ></script>
  

  
  
  

  
  <link
    rel="icon"
    href="https://theabsnt.github.io/favicon.png"
  />
  <link
    rel="apple-touch-icon"
    href="https://theabsnt.github.io/favicon.png"
  />

  
  <meta name="generator" content="Hugo 0.152.2">

  
  
  
  
  
  
  <meta itemprop="name" content="[MAD] Entry-01 : Evil Deno Caught In Wild">
  <meta itemprop="description" content="Context of this Entry The context originates from MalwareHunterTeam Tweet. This introduces an executable named GoogleDriverSetup.exe, It is compiled using Rust based JavaScript runtime called Deno. Let’s get started!
stage01 : Evil Deno It all starts with an executable that sizes to approx.81.4MB, it’s a DenoJS compiled executable: This holds the JavaScript to run in the resources section of the binary. This technique is referenced from Evil Deno. The JavaScript can be deobfuscated using deobfuscate.io. This simply contains a powershell command that’ll execute another powershell script loaded from remote URL dynamically:">
  <meta itemprop="datePublished" content="2025-11-12T16:10:18+05:30">
  <meta itemprop="dateModified" content="2025-11-12T16:10:18+05:30">
  <meta itemprop="wordCount" content="571">
  <meta itemprop="keywords" content="Reverse Engineering,Malware Analysis,Infection Chain,Mad">
  
  <meta property="og:url" content="https://theabsnt.github.io/posts/mad-entry/evil-deno/">
  <meta property="og:site_name" content="TheAbsnt">
  <meta property="og:title" content="[MAD] Entry-01 : Evil Deno Caught In Wild">
  <meta property="og:description" content="Context of this Entry The context originates from MalwareHunterTeam Tweet. This introduces an executable named GoogleDriverSetup.exe, It is compiled using Rust based JavaScript runtime called Deno. Let’s get started!
stage01 : Evil Deno It all starts with an executable that sizes to approx.81.4MB, it’s a DenoJS compiled executable: This holds the JavaScript to run in the resources section of the binary. This technique is referenced from Evil Deno. The JavaScript can be deobfuscated using deobfuscate.io. This simply contains a powershell command that’ll execute another powershell script loaded from remote URL dynamically:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-12T16:10:18+05:30">
    <meta property="article:modified_time" content="2025-11-12T16:10:18+05:30">
    <meta property="article:tag" content="Reverse Engineering">
    <meta property="article:tag" content="Malware Analysis">
    <meta property="article:tag" content="Infection Chain">
    <meta property="article:tag" content="Mad">

  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[MAD] Entry-01 : Evil Deno Caught In Wild">
  <meta name="twitter:description" content="Context of this Entry The context originates from MalwareHunterTeam Tweet. This introduces an executable named GoogleDriverSetup.exe, It is compiled using Rust based JavaScript runtime called Deno. Let’s get started!
stage01 : Evil Deno It all starts with an executable that sizes to approx.81.4MB, it’s a DenoJS compiled executable: This holds the JavaScript to run in the resources section of the binary. This technique is referenced from Evil Deno. The JavaScript can be deobfuscated using deobfuscate.io. This simply contains a powershell command that’ll execute another powershell script loaded from remote URL dynamically:">

  
  

  
  <link rel="canonical" href="https://theabsnt.github.io/posts/mad-entry/evil-deno/" />
  
  
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header class="mx-auto flex h-[4.5rem] max-w-[--w] px-8 lg:justify-center">
  <div class="relative z-50 ltr:mr-auto rtl:ml-auto flex items-center">
    <a class="-translate-y-[1px] text-2xl font-medium" href="https://theabsnt.github.io/"
      >TheAbsnt</a
    >
    <div
      class="btn-dark text-[0] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.svg)_left_center/cover_no-repeat] dark:invert dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 ltr:-mr-8 rtl:-ml-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
    role="button"
    aria-label="Menu"
  ></div>

  

  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#fbfbfb'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"
  >
    
    
    <nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse">
      
      <a
        class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal"
        href="/about/"
        >About</a
      >
      
    </nav>
    

    
    <nav
      class="mt-12 flex justify-center space-x-10 rtl:space-x-reverse dark:invert ltr:lg:ml-14 rtl:lg:mr-14 lg:mt-0 lg:items-center"
    >
      
      <a
        class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./twitter.svg)"
        href="https://twitter.com/TheAbsnt"
        target="_blank"
        rel="me"
      >
        twitter
      </a>
      
      <a
        class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./rss.svg)"
        href="https://theabsnt.github.io/index.xml"
        target="_blank"
        rel="alternate"
      >
        rss
      </a>
      
    </nav>
    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-[--w] px-8 pb-16 pt-14 dark:prose-invert"
    >
      

<article>
  <header class="mb-14">
    <h1 class="!my-0 pb-2.5">[MAD] Entry-01 : Evil Deno Caught In Wild</h1>

    
    <div class="text-xs antialiased opacity-60">
      
      <time>Nov 12, 2025</time>
      
      
      
      
      <span class="mx-1">&middot;</span>
      <span>THEABSNT</span>
      
    </div>
    
  </header>

  <section><hr>
<h1 id="context-of-this-entry">Context of this Entry</h1>
<p>The context originates from <a href="https://x.com/malwrhunterteam/status/1964023478060716437">MalwareHunterTeam Tweet</a>. This introduces an executable named <code>GoogleDriverSetup.exe</code>, It is compiled using Rust based JavaScript runtime called <a href="https://docs.deno.com/runtime/">Deno</a>. Let&rsquo;s get started!</p>
<hr>
<h1 id="stage01--evil-deno">stage01 : Evil Deno</h1>
<p>It all starts with an executable that sizes to approx.<code>81.4MB</code>, it&rsquo;s a <a href="https://docs.deno.com/runtime/reference/cli/compile/">DenoJS compiled</a> executable:
<img src="/mat-evil-deno/stg1-metadata.png" alt="stg1-metadata"></p>
<p>This holds the JavaScript to run in the resources section of the binary. This technique is referenced from <a href="https://taggart-tech.com/evildeno/">Evil Deno</a>.
<img src="/mat-evil-deno/stg1-rsrc-out.png" alt="stg1-rsrc-out"></p>
<p>The JavaScript can be deobfuscated using <a href="https://obf-io.deobfuscate.io/">deobfuscate.io</a>. This simply contains a powershell command that&rsquo;ll execute another powershell script loaded from remote URL dynamically:
<img src="/mat-evil-deno/stg1-js-decrypt.png" alt="stg1-js-decrypt"></p>
<hr>
<h1 id="stage02--set-startup-item">stage02 : set startup item</h1>
<p>This script declares some variables at first:
<img src="/mat-evil-deno/stg2-code-1.png" alt="stg2-code-1">
Downloads <code>script1.aspx</code> from an url and <code>Python3.13.7</code>:
<img src="/mat-evil-deno/stg2-code-2.png" alt="stg2-code-2">
<img src="/mat-evil-deno/stg2-code-3.png" alt="stg2-code-3">
It then sets up a system startup task that runs script (<code>script1.aspx</code>) on startup using <code>pythonw.exe</code>.</p>
<hr>
<h1 id="stage03--python-shellcode-loader">stage03 : python shellcode loader</h1>
<p>This <code>script1.aspx</code> marshal loads a python code object, then executes <code>exec()</code> after <code>base64</code> decode and <code>zlib</code> decompress:
<img src="/mat-evil-deno/stg3-script1.png" alt="stg3-script1"></p>
<p>Once we get the code-object to be loaded, we can then prepend <code>PYC</code> header of <code>16byte</code> of Python3.13 to make it a <code>PYC</code> file, then using <code>Pylingual</code> we decompile the pyc file to get following python code on the right:
<img src="/mat-evil-deno/stg3-deompil-py.png" alt="stg3-deompil-py">
As the name of the decompiled python says <code>heap_alloc_shellcode_loader.py</code>, it loads a shellcode(a DLL file) to the current process using simple <code>CreateThread()</code> call using python <code>ctypes</code> module.</p>
<hr>
<h1 id="stage04-the-dll-file">stage04: the DLL file</h1>
<p>similar samples found based on <code>imphash: c3d7ddc86c9402d44b3c8487b2ead7aa</code> :
<img src="/mat-evil-deno/stg4-imphash-pivot.png" alt="stg4-imphash-pivot">
main driver function are same, also both uses same Mutex string : <code>Global\\OALvPABeVdMtx</code>
<img src="/mat-evil-deno/stg4-main-comparision.png" alt="stg4-main-comparision"></p>
<p><code>sub_180009240()</code> of this sample performs anti-hooking setups and checks like:
<img src="/mat-evil-deno/stg4-anti-hook-1.png" alt="stg4-anti-hook-1">
<img src="/mat-evil-deno/stg4-anti-hook-2.png" alt="stg4-anti-hook-2">
Setting the <a href="https://ntdoc.m417z.com/processinfoclass#processinstrumentationcallback-40">ProcessInstrumentationCallback</a> to <code>NULL</code> via <a href="https://ntdoc.m417z.com/ntsetinformationprocess">NtSetInformationProcess</a> API call, that can be used  bypass EDR hooks.</p>
<p>Followed by code that resolves many API dynamically and check if it can get the syscall of those exports from <code>ntdll</code>, this technique checks if any trampolines are in place or not:
<img src="/mat-evil-deno/stg4-bulk-hash-resolve.png" alt="stg4-bulk-hash-resolve"></p>
<p>before and aftre running <code>sub_180009240()</code>:
<img src="/mat-evil-deno/stg4-x64-before-dump.png" alt="stg4-x64-before-dump">
<img src="/mat-evil-deno/stg4-x64-after-dump.png" alt="stg4-x64-after-dump"></p>
<p>if any anomaly detected then move onto load the module from disk:
<img src="/mat-evil-deno/stg4-anti-hook-3.png" alt=""></p>
<p>Then the sample&rsquo;s further logic comes from various vtable functions calls:
<img src="/mat-evil-deno/stg4-vtable-jmp-1.png" alt="stg4-vtable-jmp-1">
<img src="/mat-evil-deno/stg4-vtable-call-2.png" alt="stg4-vtable-call-2">
from here-on it will call function related to system recon, C2 connection, download and executes function and so on.</p>
<p>It starts off with some system recon, to eventually send to the their C2 server <code>http[:]//185.193.125[.]160/d</code> :
<img src="/mat-evil-deno/stg4-system-recon-1.png" alt="stg4-system-recon-1"></p>
<p>While i was debugging&rsquo; in my Windows10 VM and step over the following <code>IWbemLocator::ConnectServer</code> function call at offset <code>0x7AB5</code> the debugger never returned, maybe because my VM COMServer was not responding:
<img src="/mat-evil-deno/stg4-system-recon-2.png" alt="stg4-system-recon-2"></p>
<p>The other sample includes additional unpacking routine as part of anti-analysis measures before calling vtables functions, but the purpose remains the same for both samples:
<img src="/mat-evil-deno/stg4-another-sample-unpacking.png" alt="stg4-another-sample-unpacking"></p>
<p>Suspicions of these being CobaltStrike Component based on some detection:</p>
<ul>
<li><a href="https://otx.alienvault.com/indicator/file/84f34f24a7f7852ac1c5e99ec3de6e215138d7b8a39514963dc6596945b105d8">https://otx.alienvault.com/indicator/file/84f34f24a7f7852ac1c5e99ec3de6e215138d7b8a39514963dc6596945b105d8</a></li>
<li><a href="https://www.virustotal.com/gui/file/c5f717f2bb294ae97df415900c1c4e025b73fa6b709d4ed0395c3e157a3b2e0e/community">https://www.virustotal.com/gui/file/c5f717f2bb294ae97df415900c1c4e025b73fa6b709d4ed0395c3e157a3b2e0e/community</a></li>
</ul>
<hr>
<h1 id="stage05-another-python-script">stage05: another python script</h1>
<p>This stage eventually attempts to use <code>cmstp.exe</code> (to gain elevated privileges) and a malicious INF file to execute arbitrary PowerShell code from a remote source <code>https[:]//pastebin.com/raw/TvvskyQL</code>,</p>
<p>The <code>script2.aspx</code> is on the left, decoded and decompressed output is on the right:
<img src="/mat-evil-deno/stg5-script2-decoded-python-1.png" alt="stg5-script2-decoded-python-1">
<img src="/mat-evil-deno/stg5-script2-decoded-python-2.png" alt="stg5-script2-decoded-python-2">
then it simulates a user pressing Enter (via <code>ctypes</code> and window messages) to silently approve prompts.</p>
<hr>
<h1 id="stage06-multi-user-persistence">stage06: multi-user persistence</h1>
<p><img src="/mat-evil-deno/stg6-TvvskyQL.png" alt="stg6-TvvskyQL">
This script ensure persistence by creating a scheduled task for each user that&rsquo;ll execute <code>script1.aspx</code> on logon with additional settings, then starts the task immediately.</p>
<hr>
<h1 id="iocs">IOC(s)</h1>
<ul>
<li>source : <code>https://x.com/malwrhunterteam/status/1964023478060716437</code></li>
<li><code>GoogleDriverSetup.exe</code> : <code>84f34f24a7f7852ac1c5e99ec3de6e215138d7b8a39514963dc6596945b105d8</code> : <code>https://cutt[.]ly/drivefilestreamGoogleDriveexe</code> -&gt; <code>https://www.dropbox[.]com/scl/fi/fn1bowuqm3dmnr8boa295/GoogleDriverSetup.exe?rlkey=jm264ztoaocmtsufy3hepd49m&amp;st=9z0aua3v&amp;dl=1</code></li>
<li><code>ololo.aspx</code> : <code>https[:]//ololo-dsj.pages[.]dev/ololo.aspx</code></li>
<li><code>script1.aspx</code> : <code>https[:]//4243384121f3d8cfb9681a012552537f.pages.dev/script1.aspx</code></li>
<li><code>Shellcode (DLL)</code> : <code>9231e77c960570548cd053d9a9eaaf62e50e7b21b36521d82b31a02d7f9f57cd</code> has C2 <code>http[:]//185.193.125[.]160/d</code>
<ul>
<li>similar sample: <code>c5f717f2bb294ae97df415900c1c4e025b73fa6b709d4ed0395c3e157a3b2e0e</code> has C2 <code>https://swiftedgecloud[.]com/d</code></li>
</ul>
</li>
<li><code>script2.aspx</code> : <code>https://42a25631.yr52byzdja.pages[.]dev/script2.aspx</code></li>
<li><code>https://pastebin[.]com/raw/TvvskyQL</code></li>
</ul>
<hr>
<h1 id="more-reads">More reads</h1>
<ul>
<li><a href="https://unit42.paloaltonetworks.com/cobalt-strike-memory-analysis/">https://unit42.paloaltonetworks.com/cobalt-strike-memory-analysis/</a></li>
<li><a href="https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware">https://www.huntress.com/blog/cobalt-strike-analysis-of-obfuscated-malware</a></li>
<li>checking the hooks : <a href="https://www.ired.team/offensive-security/defense-evasion/detecting-hooked-syscall-functions">https://www.ired.team/offensive-security/defense-evasion/detecting-hooked-syscall-functions</a></li>
<li><a href="https://www.outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/">https://www.outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/</a></li>
<li>windows system call table : <a href="https://j00ru.vexillium.org/syscalls/nt/64/">https://j00ru.vexillium.org/syscalls/nt/64/</a></li>
<li><a href="https://splintercod3.blogspot.com/p/weaponizing-mapping-injection-with.html">https://splintercod3.blogspot.com/p/weaponizing-mapping-injection-with.html</a></li>
<li><a href="https://www.riskinsight-wavestone.com/en/2023/10/process-injection-using-ntsetinformationprocess/">https://www.riskinsight-wavestone.com/en/2023/10/process-injection-using-ntsetinformationprocess/</a></li>
<li><a href="https://www.mdsec.co.uk/2020/12/bypassing-user-mode-hooks-and-direct-invocation-of-system-calls-for-red-teams/">https://www.mdsec.co.uk/2020/12/bypassing-user-mode-hooks-and-direct-invocation-of-system-calls-for-red-teams/</a></li>
</ul>
</section>

  
  
  <footer class="mt-12 flex flex-wrap">
     
    <a
      class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://theabsnt.github.io/tags/reverse-engineering"
      >reverse engineering</a
    >
     
    <a
      class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://theabsnt.github.io/tags/malware-analysis"
      >malware analysis</a
    >
     
    <a
      class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://theabsnt.github.io/tags/infection-chain"
      >infection chain</a
    >
     
    <a
      class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://theabsnt.github.io/tags/mad"
      >mad</a
    >
    
  </footer>
  

  
  
  
  
  <nav
    class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg !leading-[1.2] *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"
  >
    
    <a class="ltr:pr-3 rtl:pl-3" href="https://theabsnt.github.io/posts/mad-entry/asus-update-to-purerat/"
      ><span class="ltr:mr-1.5 rtl:ml-1.5">←</span><span>[MAD] Entry-02 : Vietnamese spreading PureRAT-y</span></a
    >
    
    
    <a class="ltr:ml-auto rtl:mr-auto justify-end pl-3" href="https://theabsnt.github.io/posts/formbook-infection-chain/"
      ><span>Memory-Only Mayhem: JScript to Powershell to .NET Loader to Infostealer</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a
    >
    
  </nav>
  
  

  
  

  
  

  


  
</article>


    </main>

    <footer
  class="mx-auto flex h-[4.5rem] max-w-[--w] items-center px-8 text-xs uppercase tracking-wider opacity-60"
>
  <div class="mr-auto">
  
    &copy; 2025
    <a class="link" href="https://theabsnt.github.io/">TheAbsnt</a>
  
  </div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >powered by hugo️️</a
  >️
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >hugo-paper</a
  >
</footer>

  </body>
</html>
